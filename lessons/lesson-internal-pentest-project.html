<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Проект: Тестирование на проникновение (Pentest) - Cortex Academy</title>
    <link rel="stylesheet" href="/hack.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=Roboto+Mono&display=swap" rel="stylesheet">
</head>
<body class="lesson-page">

    <header>
        <div class="logo">Cortex</div>
        <nav>
            <a href="index.html">Главная</a>
            <a href="courses.html">Программа</a>
            <a href="#">Войти</a>
        </nav>
    </header>

    <div class="lesson-hero">
        <div class="lesson-hero-content">
            <span class="lesson-meta">Итоговый проект • Урок 14</span>
            <h1>Проект: Внутренний пентест</h1>
            <p>Теория окончена. Вы — пентестер, и ваша задача — скомпрометировать корпоративную сеть изнутри. Это ваш выпускной экзамен, объединяющий все полученные навыки.</p>
        </div>
    </div>

    <main class="lesson-container">
        <!-- Боковая навигация по уроку -->
        <aside class="lesson-nav">
            <h3>План проекта</h3>
            <ul>
                <li><a href="#intro" class="nav-link active">1. Устройство процесса подготовки</a></li>
                <li><a href="#recon" class="nav-link">2. Сбор информации о цели (внутренняя сеть)</a></li>
                <li><a href="#kill-chain" class="nav-link">3. Цепочка атаки (Kill Chain)</a></li>
                <li><a href="#step1" class="nav-link">3.1. Начальный доступ</a></li>
                <li><a href="#step2" class="nav-link">3.2. Закрепление и эскалация</a></li>
                <li><a href="#step3" class="nav-link">3.3. Боковое перемещение</a></li>
                <li><a href="#step4" class="nav-link">3.4. Захват домена</a></li>
                <li><a href="#reporting" class="nav-link">4. Финальный отчет</a></li>
                <li><a href="#task" class="nav-link">5. Ваше итоговое задание</a></li>
            </ul>
        </aside>

        <!-- Основной контент урока -->
        <article class="lesson-content">
            <section id="intro">
                <h2>1. Устройство процесса подготовки к атаке: Правила игры</h2>
                <p>Перед началом любого пентеста проводится этап <strong>Pre-engagement (Подготовка)</strong>. Это самая важная часть с юридической и организационной точки зрения.</p>
                <h3>Scope of Work (SoW) — Определение границ</h3>
                <p>Вы с заказчиком подписываете документ, который четко определяет:</p>
                <ul>
                    <li><strong>Цели:</strong> Что мы пытаемся достичь? (Например, "Получить права администратора домена" или "Получить доступ к базе данных клиентов").</li>
                    <li><strong>Границы (Scope):</strong> Какие IP-адреса, подсети, приложения можно атаковать? Что находится за границами (out of scope)?</li>
                    <li><strong>Правила взаимодействия (Rules of Engagement):</strong> Что можно и чего нельзя делать? Можно ли использовать DoS-атаки? В какое время можно проводить активное сканирование? Нужно ли останавливаться после получения первого доступа?</li>
                    <li><strong>Контакты:</strong> Кто ваш контакт со стороны заказчика для экстренной связи 24/7?</li>
                </ul>
                <div class="warning-box">
                    <p>Никогда не выходите за рамки Scope! Атака на хост, не указанный в договоре — это преступление, а не пентест.</p>
                </div>
                <h3>Подготовка инструментария</h3>
                <p>Ваша рабочая станция — это Kali Linux или аналог (Parrot OS), запущенный на виртуальной машине. Перед началом вы должны убедиться, что все инструменты обновлены (<code>sudo apt update && sudo apt upgrade -y</code>) и настроены.</p>
            </section>

            <section id="recon">
                <h2>2. Сбор информации о цели атаки (внутренняя сеть)</h2>
                <p>Сценарий: вы подключили свой ноутбук к порту в переговорке офиса клиента. Вы ничего не знаете о сети. Ваша первая задача — составить карту.</p>
                <h3>Шаг 1: Определение своей подсети</h3>
                <p>Сначала нужно понять, где вы находитесь.</p>
                <div class="code-block">
                    <code>ip a</code>
                    <button class="copy-btn">Копировать</button>
                </div>
                <p>Допустим, вы получили IP <code>192.168.10.123</code> с маской <code>/24</code>. Это значит, ваша цель — вся подсеть <code>192.168.10.0/24</code>.</p>
                <h3>Шаг 2: Поиск "живых" хостов</h3>
                <p>Используем Nmap для "пинг-сканирования", чтобы найти все активные устройства в подсети.</p>
                 <div class="code-block">
                    <code>sudo nmap -sn 192.168.10.0/24</code>
                    <button class="copy-btn">Копировать</button>
                </div>
                <h3>Шаг 3: Глубокое сканирование и перечисление сервисов</h3>
                <p>Сохранив список живых хостов в файл `targets.txt`, запускаем на них детальное сканирование для определения ОС, портов и сервисов.</p>
                <div class="code-block">
                    <code>sudo nmap -A -iL targets.txt -oN nmap_scan_results.txt</code>
                    <button class="copy-btn">Копировать</button>
                </div>
                <h3>Шаг 4: Пассивный анализ трафика</h3>
                <p>Пока идет сканирование, можно запустить инструменты вроде <code>Responder</code> или <code>Wireshark</code> для пассивного прослушивания сети. Это может выдать нам имена хостов, доменов и даже хэши учетных данных без единого активного запроса.</p>
            </section>
            
            <section id="kill-chain">
                <h2>3. Цепочка атаки (Cyber Kill Chain)</h2>
                <p>Kill Chain — это модель, описывающая этапы, которые проходит злоумышленник для достижения своей цели. В контексте внутреннего пентеста она выглядит так:</p>
                <pre class="ascii-diagram">
Recon -> Foothold -> Escalate -> Lateral Movement -> Persistence -> Domain Dominance
(Разведка -> Плацдарм -> Эскалация -> Боковое перемещение -> Закрепление -> Захват домена)
                </pre>
                <p>Давайте пройдем по этому пути шаг за шагом.</p>
            </section>

            <section id="step1">
                <h2 style="font-size: 1.8em;">3.1. Получение начального доступа (Initial Foothold)</h2>
                <p>Проанализировав результаты сканирования, мы ищем самую простую точку входа. Это может быть:</p>
                <ul>
                    <li><strong>Уязвимый веб-сервер:</strong> Старая версия Jenkins, Apache Tomcat с дефолтными паролями, уязвимость в самописном приложении.</li>
                    <li><strong>Протокол SMB:</strong> Анонимный доступ к файловым шарам, уязвимость MS17-010 (EternalBlue).</li>
                    <li><strong>Слабые пароли:</strong> Подбор паролей к SSH, RDP, FTP, используя популярные комбинации (Password Spraying).</li>
                    <li><strong>Перехваченные хэши:</strong> Использование хэшей, полученных с помощью <strong>Responder</strong>, для аутентификации на других машинах (Pass-the-Hash).</li>
                </ul>
                <div class="info-box">
                    <p><strong>Пример:</strong> Nmap показал, что на <code>192.168.10.50</code> открыт порт 8080 с Apache Tomcat. Мы проверяем в браузере и видим стандартную страницу входа. Пробуем стандартные пароли (`admin:admin`, `tomcat:s3cret`) и получаем доступ к панели администратора, откуда можем загрузить веб-шелл.</p>
                </div>
            </section>
            
            <section id="step2">
                <h2 style="font-size: 1.8em;">3.2. Закрепление и повышение привилегий (Persistence & Escalation)</h2>
                <p>Итак, у нас есть доступ к системе, но обычно с правами низкопривилегированного пользователя (например, `www-data`). Наша цель — стать <code>root</code> или `NT AUTHORITY\SYSTEM`.</p>
                <h3>Закрепление (Persistence)</h3>
                <p>Нужно обеспечить себе доступ к системе даже после перезагрузки. Это можно сделать, добавив себя в автозагрузку, создав задачу в cron/планировщике задач или установив бэкдор.</p>
                <h3>Повышение привилегий (Privilege Escalation)</h3>
                <p>Это поиск уязвимостей и мисконфигураций внутри самой ОС.</p>
                <ul>
                    <li><strong>Автоматизированный поиск:</strong> Скрипты <strong>LinPEAS</strong> (для Linux) и <strong>WinPEAS</strong> (для Windows) ищут сотни известных векторов для повышения привилегий.</li>
                    <li><strong>Частые векторы:</strong></li>
                        <ul>
                            <li><strong>Уязвимости ядра (Kernel Exploits):</strong> Устаревшая версия ядра. Опасно, может привести к "синему экрану".</li>
                            <li><strong>Неправильные права на файлы/папки:</strong> Возможность перезаписать системный файл.</li>
                            <li><strong>SUID-бинарники (Linux):</strong> Поиск программ с SUID-битом, которые можно проэксплуатировать.</li>
                            <li><strong>Слабые пароли в файлах конфигурации.</strong></li>
                        </ul>
                </ul>
            </section>

            <section id="step3">
                <h2 style="font-size: 1.8em;">3.3. Боковое перемещение (Lateral Movement)</h2>
                <p>Мы захватили одну машину и стали на ней администратором. Но наша цель — контроллер домена. Теперь мы используем скомпрометированную машину как плацдарм для атаки на другие хосты в сети.</p>
                <h3>Сбор учетных данных</h3>
                <p>Став администратором, мы можем запустить <strong>Mimikatz</strong> (на Windows), чтобы извлечь из памяти пароли и хэши всех пользователей, которые когда-либо логинились на этой машине, в открытом виде!</p>
                <h3>Pass-the-Hash (PtH) и Pass-the-Ticket (PtT)</h3>
                <p>Используя полученные хэши и Kerberos-билеты, мы можем аутентифицироваться на других машинах от имени других пользователей, не зная их паролей. Набор утилит <strong>Impacket</strong> идеально для этого подходит.</p>
                 <div class="code-block">
                    <code># Пример использования PsExec из Impacket для получения удаленной консоли
# с помощью NTLM-хэша администратора
psexec.py -hashes :<ntlm_hash> administrator@192.168.10.20</code>
                    <button class="copy-btn">Копировать</button>
                </div>
            </section>
            
            <section id="step4">
                <h2 style="font-size: 1.8em;">3.4. Захват домена (Domain Dominance)</h2>
                <p>Цель близка. Мы перемещаемся по сети от машины к машине, собирая все больше учетных данных. Рано или поздно мы найдем хэш пароля одного из администраторов домена.</p>
                <p><strong>BloodHound</strong> — наш главный навигатор. Он строит граф, который показывает самый короткий путь для получения прав Domain Admin от нашего текущего положения.</p>
                <p>Получив права администратора домена, мы можем выполнить финальные атаки:</p>
                <ul>
                    <li><strong>DCSync:</strong> Заставить контроллер домена "поделиться" хэшами паролей всех пользователей в домене, включая учетную запись `krbtgt`.</li>
                    <li><strong>Golden Ticket:</strong> Используя хэш `krbtgt`, создать "золотой билет" Kerberos, который дает нам права администратора домена на 10 лет и практически не обнаруживается.</li>
                </ul>
                <p>На этом этапе цель пентеста достигнута. Мы получили полный контроль.</p>
            </section>
            
            <section id="reporting">
                <h2>4. Финальный отчет: Продукт вашей работы</h2>
                <p>Эксплуатация — это весело, но заказчик платит не за это. Он платит за <strong>отчет</strong>. Это самый важный результат вашей работы. Хороший отчет должен быть понятен как техническому специалисту, так и топ-менеджеру.</p>
                <p><strong>Структура отчета:</strong></p>
                <ol>
                    <li><strong>Резюме для руководства (Executive Summary):</strong> 1-2 страницы. Никаких технических терминов. Описывает общую оценку защищенности, ключевые риски для бизнеса и стратегические рекомендации.</li>
                    <li><strong>Техническая часть:</strong>
                        <ul>
                            <li><strong>Описание методологии и области тестирования.</strong></li>
                            <li><strong>Детальное описание каждой найденной уязвимости:</strong>
                                <ul>
                                    <li>Название и оценка по CVSS.</li>
                                    <li>Описание: что это за уязвимость и где найдена.</li>
                                    <li>Доказательство (Proof of Concept): скриншоты, команды, которые вы выполняли.</li>
                                    <li>Оценка бизнес-риска.</li>
                                    <li><strong>Рекомендации по устранению.</strong></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li><strong>Приложения:</strong> Полные выводы сканеров, логи и т.д.</li>
                </ol>
            </section>
            
            <section id="task">
                <h2>5. Ваше итоговое задание: Разработка плана атаки</h2>
                <p>Вы — пентестер, которому поручили провести внутренний пентест сети `10.10.0.0/24`. Заказчик предоставил вам физический доступ. Ваша задача — не провести атаку, а составить детальный **план работ (Methodology of Work)**.</p>
                <p>Опишите ваши действия по следующему плану:</p>
                <ol>
                    <li><strong>Подготовка:</strong> Какие 3 ключевых пункта вы бы обязательно включили в "Правила взаимодействия" (RoE)? Какие основные инструменты должны быть готовы на вашей Kali-машине?</li>
                    <li><strong>Сбор информации:</strong> Какую первую команду Nmap вы выполните, оказавшись в сети? Что вы будете делать с ее результатами?</li>
                    <li><strong>Цепочка атаки (первые шаги):</strong> Опишите гипотетический сценарий, как бы вы получили первоначальный доступ, основываясь на "типичных" результатах сканирования (например, вы нашли открытый SMB и веб-сервер).</li>
                    <li><strong>Повышение привилегий:</strong> Получив доступ к Linux-хосту под пользователем `www-data`, какие 3 вещи вы проверите в первую очередь для повышения привилегий?</li>
                    <li><strong>Отчетность:</strong> Назовите 3 главных раздела, которые должны быть в вашем финальном отчете.</li>
                </ol>
                <p>Этот план покажет, что вы не просто знаете отдельные команды, а понимаете целостную методологию и способны мыслить как профессиональный пентестер.</p>
            </section>
        </article>
    </main>

    <footer>
        <p>&copy; 2024 Cortex Academy. Знания — это свобода.</p>
    </footer>

    <script src="/hack.js"></script>
</body>
</html>