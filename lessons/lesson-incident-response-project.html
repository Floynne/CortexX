<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Проект: Расследование инцидента (Incident Response) - Cortex Academy</title>
    <link rel="stylesheet" href="/hack.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@4-00;600;700;800&family=Roboto+Mono&display=swap" rel="stylesheet">
</head>
<body class="lesson-page">

    <header>
        <div class="logo">Cortex X</div>
        <nav>
            <a href="index.html">Главная</a>
            <a href="courses.html">Программа</a>
            <a href="#">Войти</a>
        </nav>
    </header>

    <div class="lesson-hero">
        <div class="lesson-hero-content">
            <span class="lesson-meta">Итоговый проект • Урок 15</span>
            <h1>Проект: Расследование инцидента</h1>
            <p>Звучит сирена. Вы — цифровой пожарный и детектив. Ваша задача — из крупиц данных восстановить картину атаки, остановить злоумышленника и не дать ему вернуться.</p>
        </div>
    </div>

    <main class="lesson-container">
        <!-- Боковая навигация по уроку -->
        <aside class="lesson-nav">
            <h3>Этапы реагирования (NIST)</h3>
            <ul>
                <li><a href="#intro" class="nav-link active">1. Жизненный цикл инцидента</a></li>
                <li><a href="#identification" class="nav-link">2. Идентификация: Картина из хаоса</a></li>
                <li><a href="#containment" class="nav-link">3. Сдерживание: Остановить кровотечение</a></li>
                <li><a href="#eradication" class="nav-link">4. Искоренение: Исследование и удаление</a></li>
                <li><a href="#recovery" class="nav-link">5. Восстановление: Возврат к норме</a></li>
                <li><a href="#lessons-learned" class="nav-link">6. Пост-инцидентный анализ</a></li>
                <li><a href="#task" class="nav-link">7. Ваше итоговое задание</a></li>
            </ul>
        </aside>

        <!-- Основной контент урока -->
        <article class="lesson-content">
            <section id="intro">
                <h2>1. Жизненный цикл реагирования на инциденты</h2>
                <p>Реагирование на инциденты (Incident Response, IR) — это не хаотичные действия, а четко структурированный процесс. Мы будем следовать стандарту NIST SP 800-61, который определяет 4 основных фазы (плюс подготовка и пост-анализ):</p>
                <pre class="ascii-diagram">
        +------------------+
        |   1. Preparation | -> Подготовка до инцидента
        +------------------+
                  |
+-------------------------------------------------------------+
|                 ЦИКЛ РЕАГИРОВАНИЯ                           |
|                                                             |
|   +------------------+      +------------------+            |
|   | 2. Detection &   |----->| 3. Containment,  |            |
|   |    Analysis      |      |    Eradication,  |            |
|   +------------------+      |    & Recovery    |            |
|           ^                 +------------------+            |
|           |                           |                     |
+-------------------------------------------------------------+
                  |
        +------------------+
        | 4. Post-Incident | -> Анализ после инцидента
        |     Activity     |
        +------------------+
                </pre>
                <p>Наша задача — пройти через весь этот цикл на примере реалистичного сценария.</p>
            </section>

            <section id="identification">
                <h2>2. Идентификация: Выстраивание картины с нуля</h2>
                <p><strong>Сценарий:</strong> В техподдержку поступает заявка от бухгалтера Анны Ивановой: "Мой компьютер работает очень медленно, и антивирус выдает какие-то странные предупреждения". У вас нет никаких других исходных данных.</p>
                <h3>Шаг 1: Первичный сбор информации (Triage)</h3>
                <p>Первые вопросы, которые вы задаете:</p>
                <ul>
                    <li>ФИО пользователя: Анна Иванова</li>
                    <li>Имя компьютера (hostname): `ACC-WKS-05`</li>
                    <li>IP-адрес: `10.1.5.25`</li>
                    <li>Время возникновения проблемы: "Примерно час назад"</li>
                </ul>
                <h3>Шаг 2: Использование системы мониторинга (SIEM)</h3>
                <p>Это ваш главный инструмент на этом этапе. Вы открываете SIEM (например, ELK Stack или Splunk) и начинаете "копать":</p>
                <div class="code-block">
                    <code>// Псевдо-запрос в SIEM
(hostname:"ACC-WKS-05" OR source_ip:"10.1.5.25") AND timestamp > "now-2h"</code>
                    <button class="copy-btn">Копировать</button>
                </div>
                <p><strong>На что вы обращаете внимание:</strong></p>
                <ul>
                    <li><strong>События EDR/Антивируса:</strong> Вы видите алерт: `"powershell.exe spawned a suspicious process cmd.exe which attempted to connect to 185.141.25.142"`. Это наш первый <strong>Индикатор Компрометации (IoC)</strong>.</li>
                    <li><strong>Сетевые логи (Firewall/Proxy):</strong> Фильтруете по IP `185.141.25.142`. Видите, что соединение было установлено по порту 443, но WAF/IPS помечает его как "Anomalous C2 Traffic". Это подтверждает, что IP — вредоносный (Command & Control сервер).</li>
                    <li><strong>Логи аутентификации:</strong> За 10 минут до алерта EDR вы видите успешный вход пользователя `a.ivanova` с IP-адреса, который ей не свойственен.</li>
                </ul>
                <p><strong>Картина начинает проясняться:</strong> Учетная запись Анны была скомпрометирована, злоумышленник залогинился и запустил вредоносный PowerShell-скрипт, который установил соединение с C2-сервером.</p>
            </section>
            
            <section id="containment">
                <h2>3. Сдерживание: Остановить распространение огня</h2>
                <p>Цель этого этапа — не дать атаке распространиться дальше. Скорость имеет решающее значение.</p>
                <p><strong>Краткосрочные меры (немедленные действия):</strong></p>
                <ol>
                    <li><strong>Изоляция хоста:</strong> С помощью EDR или сетевых средств (NAC) изолируем хост `ACC-WKS-05` от остальной сети. Он может "говорить" только с серверами ИБ-команды. <strong>Важно: не выключайте компьютер!</strong> Это уничтожит все улики в оперативной памяти.</li>
                    <li><strong>Блокировка IoC:</strong> Немедленно добавляем IP-адрес C2-сервера (`185.141.25.142`) в черный список на пограничном файрволе.</li>
                    <li><strong>Блокировка учетной записи:</strong> Отключаем учетную запись `a.ivanova` в Active Directory и сбрасываем ее пароль, чтобы злоумышленник не мог использовать ее для бокового перемещения.</li>
                </ol>
                <div class="pro-tip-box">
                    <p>Иногда полное отключение хоста невозможно (например, если это критически важный сервер). В таких случаях применяют "мягкую" изоляцию — ограничивают его сетевые взаимодействия только необходимым минимумом.</p>
                </div>
            </section>

            <section id="eradication">
                <h2>4. Искоренение: Исследование атакуемой инфраструктуры</h2>
                <p>Теперь, когда угроза локализована, начинается глубокая детективная работа. Наша задача — найти и удалить все следы присутствия злоумышленника.</p>
                <h3>Шаг 1: Сбор доказательств (Форензика)</h3>
                <p>Мы работаем с изолированным хостом `ACC-WKS-05`.</p>
                <ul>
                    <li><strong>Снятие дампа оперативной памяти:</strong> Используем утилиты вроде <strong>FTK Imager Lite</strong> или <strong>WinPmem</strong> для создания полной копии RAM. Это самый ценный артефакт.</li>
                    <li><strong>Создание образа диска:</strong> С помощью `dd` (в Linux) или того же FTK Imager создаем побитную копию диска. <strong>Всегда работаем только с копией!</strong></li>
                </ul>
                <h3>Шаг 2: Анализ</h3>
                <p><strong>Анализ памяти (с помощью Volatility Framework):</strong></p>
                <ul>
                    <li><code>pstree</code>: Посмотреть дерево процессов. Мы видим, что `explorer.exe` запустил `OUTLOOK.EXE`, тот запустил `WINWORD.EXE`, а тот — `powershell.exe`. Это указывает на фишинговую атаку через вложение в письме.</li>
                    <li><code>netscan</code>: Посмотреть сетевые соединения, которые были активны в момент снятия дампа. Мы видим то самое соединение с `185.141.25.142`.</li>
                    <li><code>malfind</code>: Поиск скрытого или внедренного в память другого процесса кода (code injection).</li>
                </ul>
                <p><strong>Анализ диска (с помощью Autopsy или SIFT Workstation):</strong></p>
                <ul>
                    <li><strong>Поиск вредоносного файла:</strong> Находим PowerShell-скрипт, который был запущен.</li>
                    <li><strong>Анализ механизмов закрепления (Persistence):</strong> Проверяем ключи автозагрузки в реестре, планировщик задач, WMI-подписки на наличие следов вредоноса.</li>
                    <li><strong>Восстановление удаленных файлов:</strong> Ищем файлы, которые злоумышленник мог удалить, чтобы скрыть следы.</li>
                </ul>
            </section>
            
            <section id="recovery">
                <h2>5. Восстановление: Безопасный возврат в строй</h2>
                <p>После того как мы уверены, что полностью удалили вредонос и поняли вектор атаки, мы можем приступать к восстановлению.</p>
                <ul>
                    <li><strong>Переустановка ОС:</strong> Самый надежный способ — не "лечить" систему, а полностью переустановить ее из заведомо чистого "золотого образа".</li>
                    <li><strong>Восстановление данных:</strong> Данные пользователя восстанавливаются из бэкапа, сделанного до инцидента.</li>
                    <li><strong>Сброс паролей:</strong> Все пароли, которые могли быть скомпрометированы (не только Анны, но и других пользователей, чьи хэши могли быть украдены с машины), должны быть сброшены.</li>
                    <li><strong>Мониторинг:</strong> После возвращения машины в строй мы устанавливаем для нее режим усиленного мониторинга на несколько дней, чтобы убедиться, что злоумышленник не вернется.</li>
                </ul>
            </section>
            
            <section id="lessons-learned">
                <h2>6. Пост-инцидентный анализ (Lessons Learned)</h2>
                <p>Это самый важный этап для стратегического улучшения безопасности. Мы собираем всех участников и анализируем инцидент.</p>
                <div class="warning-box">
                    <p>Цель — не найти виновного ("Почему Анна открыла этот файл?"), а найти недостатки в системе ("Почему наши технические средства пропустили этот фишинг и почему у Анны были избыточные права?").</p>
                </div>
                <p><strong>Результаты анализа:</strong></p>
                <ul>
                    <li><strong>Корневая причина (Root Cause):</strong> Фишинговое письмо с вредоносным макросом.</li>
                    <li><strong>Что сработало хорошо:</strong> EDR обнаружил аномальную активность, команда IR быстро среагировала.</li>
                    <li><strong>Что можно улучшить:</strong>
                        <ul>
                            <li><strong>Технически:</strong> Улучшить правила на почтовом шлюзе для блокировки макросов. Внедрить более строгие правила AppLocker, запрещающие запуск PowerShell из офисных приложений.</li>
                            <li><strong>Организационно:</strong> Провести внеплановый тренинг по фишингу для отдела бухгалтерии. Пересмотреть права доступа для бухгалтеров по принципу наименьших привилегий.</li>
                        </ul>
                    </li>
                </ul>
            </section>
            
            <section id="reporting">
                <h2>7. Визуализация данных и отчёты</h2>
                <p>Как и в пентесте, финальный отчет — ключевой документ.</p>
                <p><strong>Отчет об инциденте должен содержать:</strong></p>
                <ul>
                    <li><strong>Резюме для руководства:</strong> Краткое описание инцидента, его влияния на бизнес и принятых мер.</li>
                    <li><strong>Детальная хронология событий (Timeline):</strong> Поминутное восстановление всей цепочки атаки, от получения фишингового письма до полного восстановления.</li>
                    <li><strong>Анализ корневых причин (Root Cause Analysis).</strong></li>
                    <li><strong>Собранные доказательства и IoC.</strong></li>
                    <li><strong>План действий по улучшению (Action Plan)</strong> с конкретными задачами, ответственными и сроками.</li>
                </ul>
                <p>Дашборды в SIEM и EDR помогают визуализировать атаку и представить ее руководству в наглядном виде.</p>
            </section>
            
            <section id="task">
                <h2>8. Ваше итоговое задание: План реагирования</h2>
                <p>Вы — аналитик SOC. В 03:00 ночи SIEM генерирует алерт: "Multiple failed login attempts for user 'admin' on server 'WEB-PROD-01' from IP 203.0.113.50, followed by a successful login." (Множественные неудачные попытки входа для пользователя 'admin' на сервере 'WEB-PROD-01' с IP 203.0.113.50, за которыми последовал успешный вход).</p>
                <p><strong>Ваша задача:</strong> Написать краткий, но четкий план действий (Playbook) для дежурного аналитика.</p>
                <ol>
                    <li><strong>Идентификация (2-3 шага):</strong> Какие первые проверки вы сделаете в SIEM и других системах, чтобы подтвердить или опровергнуть инцидент?</li>
                    <li><strong>Сдерживание (2 немедленных действия):</strong> Какие две вещи вы сделаете в первую очередь, если инцидент подтвердится?</li>
                    <li><strong>Искоренение (1 ключевой артефакт):</strong> Какой самый важный артефакт вы должны собрать с сервера `WEB-PROD-01` для расследования?</li>
                    <li><strong>Пост-инцидентный анализ (1 главный вопрос):</strong> Какой главный вопрос вы зададите на разборе полетов, чтобы предотвратить повторение этого инцидента?</li>
                </ol>
                <p>Этот кейс проверяет вашу способность быстро принимать решения в стрессовой ситуации и применять на практике весь жизненный цикл реагирования на инциденты.</p>
            </section>
        </article>
    </main>

    <footer>
        <p>&copy; 2024 Cortex Academy. Знания — это свобода.</p>
    </footer>

    <script src="/hack.js"></script>
</body>
</html>