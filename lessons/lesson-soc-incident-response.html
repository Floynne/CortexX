<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Урок 11: Мониторинг и реагирование - Cortex Academy</title>
    <link rel="stylesheet" href="/hack.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=Roboto+Mono&display=swap" rel="stylesheet">
</head>
<body class="lesson-page">

    <header>
        <div class="logo">Cortex X</div>
        <nav>
            <a href="index.html">Главная</a>
            <a href="courses.html">Программа</a>
            <a href="#">Войти</a>
        </nav>
    </header>

    <div class="lesson-hero">
        <div class="lesson-hero-content">
            <span class="lesson-meta">Модуль 4 • Урок 11</span>
            <h1>Мониторинг и реагирование на инциденты</h1>
            <p>Наденьте гарнитуру аналитика SOC. Научитесь видеть атаки в потоке данных, расследовать их по шагам и координировать защиту в режиме реального времени.</p>
        </div>
    </div>

    <main class="lesson-container">
        <!-- Боковая навигация по уроку -->
        <aside class="lesson-nav">
            <h3>Содержание урока</h3>
            <ul>
                <li><a href="#inventory" class="nav-link active">1. Инвентаризация: Что мы защищаем?</a></li>
                <li><a href="#metrics" class="nav-link">2. Выделение параметров мониторинга</a></li>
                <li><a href="#sources" class="nav-link">3. Источники событий (логи)</a></li>
                <li><a href="#siem-magic" class="nav-link">4. Нормализация и корреляция в SIEM</a></li>
                <li><a href="#playbooks" class="nav-link">5. Playbook: Алгоритмы реагирования</a></li>
                <li><a href="#incident-analysis" class="nav-link">6. Анализ инцидента и сбор доказательств</a></li>
                <li><a href="#remediation" class="nav-link">7. Устранение последствий</a></li>
                <li><a href="#reporting" class="nav-link">8. Визуализация и отчёты</a></li>
            </ul>
        </aside>

        <!-- Основной контент урока -->
        <article class="lesson-content">
            <section id="inventory">
                <h2>1. Инвентаризация инфраструктуры: Нельзя защитить то, о чем не знаешь</h2>
                <p>Первый шаг любого проекта по мониторингу — это полная и доскональная инвентаризация. Вы должны знать каждый актив в вашей сети. Этот процесс называется <strong>управление активами (Asset Management)</strong>.</p>
                <p><strong>Что нужно инвентаризировать:</strong></p>
                <ul>
                    <li><strong>Аппаратные активы:</strong> Серверы, рабочие станции, ноутбуки, сетевое оборудование (маршрутизаторы, коммутаторы), мобильные устройства.</li>
                    <li><strong>Программные активы:</strong> Операционные системы, установленное ПО, базы данных, веб-серверы.</li>
                    <li><strong>Данные:</strong> Где хранятся самые ценные данные (персональные, финансовые, коммерческая тайна)? Классификация данных — ключевой этап.</li>
                    <li><strong>Сетевая топология:</strong> Актуальная карта сети со всеми подсетями, VLAN'ами, точками входа и выхода.</li>
                </ul>
                <div class="pro-tip-box">
                    <p>Этот процесс должен быть автоматизирован. Используйте сканеры сети (например, Nmap), системы инвентаризации (GLPI, Snipe-IT) и CMDB (Configuration Management Database) для поддержания этой информации в актуальном состоянии.</p>
                </div>
            </section>

            <section id="metrics">
                <h2>2. Выделение параметров мониторинга: На что смотреть?</h2>
                <p>После инвентаризации мы определяем, какие именно параметры (метрики и события) мы будем отслеживать для каждого типа активов. Цель — покрыть все критически важные аспекты работы и безопасности.</p>
                <table>
                  <thead><tr><th>Тип актива</th><th>Ключевые параметры для мониторинга</th></tr></thead>
                  <tbody>
                    <tr><td><strong>Серверы (Windows/Linux)</strong></td><td>Загрузка CPU, использование RAM и диска, сетевая активность, события входа/выхода (успешные и неудачные), создание/удаление пользователей, изменения в критических файлах, запуск новых процессов.</td></tr>
                    <tr><td><strong>Сетевое оборудование</strong></td><td>Утилизация каналов, ошибки на интерфейсах, изменения конфигурации, события VPN-подключений, срабатывания ACL (списков доступа).</td></tr>
                    <tr><td><strong>Веб-приложение</strong></td><td>Количество запросов (RPS), время ответа, количество ошибок (4xx, 5xx), срабатывания WAF, попытки SQL-инъекций и XSS.</td></tr>
                    <tr><td><strong>База данных</strong></td><td>Нагрузка, время выполнения запросов, неудачные попытки аутентификации, запросы от необычных источников, DDL/DCL операции.</td></tr>
                  </tbody>
                </table>
            </section>
            
            <section id="sources">
                <h2>3. Источники событий: Где рождается правда</h2>
                <p>Все параметры, которые мы выделили, фиксируются в виде <strong>событий (events)</strong>, которые записываются в <strong>журналы (логи)</strong>. Это наши "глаза и уши" в инфраструктуре.</p>
                <p><strong>Основные источники логов для SIEM-системы:</strong></p>
                <ul>
                    <li><strong>Операционные системы:</strong> Windows Event Log (Security, System, Application), Linux Syslog, Auditd.</li>
                    <li><strong>Сетевое оборудование:</strong> Syslog от маршрутизаторов, коммутаторов, файрволов.</li>
                    <li><strong>Средства защиты:</strong> Логи антивирусов/EDR, IDS/IPS, WAF, VPN-шлюзов.</li>
                    <li><strong>Приложения:</strong> Логи веб-серверов (Apache, Nginx), баз данных (PostgreSQL, MSSQL), бизнес-приложений.</li>
                    <li><strong>Облачные сервисы:</strong> AWS CloudTrail, Azure Monitor, Google Cloud Logging.</li>
                </ul>
                <div class="info-box">
                    <p>Ключевая задача — обеспечить <strong>полноту и целостность</strong> сбора логов. Если логи не собираются или их можно незаметно изменить, вся система мониторинга бесполезна.</p>
                </div>
            </section>

            <section id="siem-magic">
                <h2>4. Нормализация, корреляция, аналитика в SIEM</h2>
                <p>Сырые логи от разных систем выглядят по-разному. Чтобы с ними можно было работать, SIEM-система выполняет несколько магических преобразований.</p>
                <ol>
                    <li><strong>Нормализация:</strong> Процесс приведения всех событий к единому формату (например, Common Event Format). SIEM "разбирает" сырую строку лога (<code>"Dec 10 12:00:01 sshd[1234]: Failed password for root from 1.2.3.4"</code>) на стандартизированные поля: <code>timestamp</code>, <code>hostname</code>, <code>process_name</code>, <code>event_type</code>, <code>source_ip</code>, <code>username</code>.</li>
                    <li><strong>Обогащение (Enrichment):</strong> SIEM добавляет к событию дополнительный контекст. К IP-адресу <code>1.2.3.4</code> добавляется информация о его геолокации (GeoIP) и репутации (является ли он известным источником атак). К логину `bsmith` добавляется ФИО и должность из Active Directory.</li>
                    <li><strong>Корреляция:</strong> Это мозг SIEM. Система анализирует нормализованные и обогащенные события из РАЗНЫХ источников и ищет в них признаки сложных, распределенных во времени атак.</li>
                </ol>
                <h3>Пример правила корреляции:</h3>
                <p>ЕСЛИ (Событие "Неудачный вход по VPN" для пользователя X) И (в течение 5 минут после этого Событие "Успешный вход по VPN" для того же пользователя X, но с IP-адреса из другой страны) ТОГДА создать алерт "Подозрение на компрометацию учетных данных VPN".</p>
            </section>
            
            <section id="playbooks">
                <h2>5. Playbook: Алгоритмы реагирования на инциденты</h2>
                <p><strong>Playbook (или Standard Operating Procedure, SOP)</strong> — это пошаговая инструкция для аналитика, что именно делать при срабатывании конкретного алерта. Плейбуки устраняют хаос и гарантируют, что даже в стрессовой ситуации будут выполнены все необходимые действия.</p>
                <h3>Пример плейбука для алерта "Возможная фишинговая атака":</h3>
                <ol>
                    <li><strong>Идентификация:</strong>
                        <ul>
                            <li>Проанализировать заголовок письма (поля `Received`, `Return-Path`).</li>
                            <li>Проверить репутацию IP-адреса отправителя и домена в Threat Intelligence базах (VirusTotal, AbuseIPDB).</li>
                            <li>Проанализировать вложения и ссылки в "песочнице".</li>
                        </ul>
                    </li>
                    <li><strong>Сдерживание (Containment):</strong>
                        <ul>
                            <li>Если фишинг подтвержден, заблокировать IP-адрес отправителя на почтовом шлюзе и файрволе.</li>
                            <li>Запустить поиск по всем почтовым ящикам и удалить аналогичные письма.</li>
                            <li>Если пользователь перешел по ссылке и ввел данные — немедленно заблокировать его учетную запись и сбросить пароль.</li>
                        </ul>
                    </li>
                    <li><strong>Ликвидация (Eradication):</strong> Убедиться, что на машине пользователя не было установлено вредоносное ПО.</li>
                    <li><strong>Восстановление (Recovery):</strong> Разблокировать учетную запись пользователя с новым паролем.</li>
                    <li><strong>Пост-инцидентный анализ:</strong> Проанализировать, почему фишинг прошел через фильтры, и донастроить их. Провести дополнительное обучение для пользователя.</li>
                </ol>
            </section>
            
            <section id="incident-analysis">
                <h2>6. Анализ инцидента и сбор доказательств (Форензика)</h2>
                <p>Это процесс глубокого расследования инцидента для ответа на вопросы: "Что произошло? Как это произошло? Какой ущерб нанесен?". Здесь важен принцип <strong>сохранности улик (Chain of Custody)</strong>.</p>
                <p>Ключевой навык — умение "читать" артефакты операционной системы:</p>
                <ul>
                    <li><strong>Анализ памяти (RAM Forensics):</strong> Снятие дампа оперативной памяти (с помощью утилит вроде FTK Imager, Volatility) позволяет найти запущенные процессы, сетевые соединения, ключи шифрования, которые исчезнут после перезагрузки.</li>
                    <li><strong>Анализ диска:</strong> Поиск вредоносных файлов, анализ логов, MFT (Master File Table) в NTFS, временных файлов, реестра Windows, истории браузера.</li>
                    <li><strong>Сетевая форензика:</strong> Анализ дампов трафика (PCAP-файлов) для восстановления сессии злоумышленника и определения, какие данные были украдены.</li>
                </ul>
            </section>
            
            <section id="remediation">
                <h2>7. Устранение последствий и недопущение инцидентов в будущем</h2>
                <p>Работа не заканчивается, когда атака остановлена. Самый важный этап — это извлечение уроков.</p>
                <p><strong>Устранение (Remediation):</strong></p>
                <ul>
                    <li>Установка необходимых патчей и обновлений.</li>
                    <li>Изменение уязвимых конфигураций.</li>
                    <li>Блокировка скомпрометированных учетных записей и сброс паролей.</li>
                    <li>Переустановка системы из "золотого образа", если есть подозрение, что она полностью скомпрометирована.</li>
                </ul>
                <p><strong>Пост-инцидентный анализ (Lessons Learned):</strong></p>
                <p>Команда собирается и отвечает на вопросы:</p>
                <ul>
                    <li>Что мы сделали хорошо?</li>
                    <li>Где мы действовали медленно или неэффективно?</li>
                    <li>Каковы были корневые причины инцидента (не только технические, но и организационные)?</li>
                    <li>Какие изменения в процессах, технологиях или обучении нам нужно внести, чтобы подобное не повторилось?</li>
                </ul>
                <div class="warning-box">
                    <p>Цель этого этапа — не найти виновных, а улучшить систему. Культура "Blameless Post-Mortem" (разбор полетов без обвинений) — признак зрелой компании.</p>
                </div>
            </section>

            <section id="reporting">
                <h2>8. Визуализация данных и отчёты</h2>
                <p>Данные мониторинга должны быть понятны не только техническим специалистам, но и руководству. Для этого используются <strong>дашборды</strong> — интерактивные панели с графиками и ключевыми метриками.</p>
                <p><strong>Что должно быть на дашборде SOC:</strong></p>
                <ul>
                    <li>Карта атак в реальном времени.</li>
                    <li>Топ-10 самых частых алертов.</li>
                    <li>Топ-10 атакующих IP-адресов.</li>
                    <li>Количество событий в секунду (EPS).</li>
                    <li>Статус ключевых систем и каналов связи.</li>
                </ul>
                <p><strong>Отчеты</strong> формируются на регулярной основе (ежедневные, еженедельные, ежемесячные) и по итогам крупных инцидентов. Отчет для руководства должен быть написан на языке бизнеса, с акцентом на риски и финансовые показатели, а не на технические детали.</p>
            </section>
        </article>
    </main>

    <footer>
        <p>&copy; 2024 Cortex Academy. Знания — это свобода.</p>
    </footer>

    <script src="/hack.js"></script>
</body>
</html>